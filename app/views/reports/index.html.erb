<div class="flex justify-between items-center">
  <div>
    <h1 class="text-3xl font-bold tracking-tight">Report Mensile</h1>
    <p class="text-base-content/60">Riepilogo incassi contanti</p>
  </div>

  <div class="join">
    <%= link_to reports_path(date: @date.prev_month), class: "btn btn-sm join-item" do %>
      <%= icon("arrow_left") %>
    <% end %>

    <button class="btn btn-sm btn-disabled join-item no-animation font-mono text-primary w-32">
      <%= format_date(@date, format: "%B %Y").capitalize %>
    </button>

    <%= link_to reports_path(date: @date.next_month), class: "btn btn-sm join-item" do %>
      <%= icon("arrow_right") %>
    <% end %>
  </div>
</div>

<%= render "shared/table", pagy: @pagy do %>
  <thead>
    <tr class="bg-base-200/50">
      <th>Data</th>
      <th class="text-right">Mattina</th>
      <th class="text-right">Pomeriggio</th>
      <th class="text-right font-bold pr-6">Totale</th>
      <th>Azioni</th>
    </tr>
  </thead>

  <tbody>
    <% @daily_reports.each do |report| %>
      <tr class="<%= 'bg-primary/5' if report.date == Date.current %>">
        <td class="font-mono">
          <%= l(report.date, format: :short) %>

          <% if report.date == Date.current %>
            <span class="badge badge-xs badge-primary ml-1">Oggi</span>
          <% end %>
        </td>

        <td class="text-right opacity-80">
          <%= format_money(report.morning_total) %>
        </td>

        <td class="text-right opacity-80">
          <%= format_money(report.afternoon_total) %>
        </td>

        <td class="text-right font-bold font-mono pr-6">
          <%= format_money(report.total) %>
        </td>

        <td class="text-right w-1">
          <% unless report.empty? %>
            <%= link_to report_path("daily_cash", date: report.date),
			class: "btn btn-ghost btn-xs btn-square tooltip tooltip-left", 
			data: { tip: "Dettaglio" } do %>
              <%= icon("view", size: 16) %>
            <% end %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>

  <tfoot>
    <tr class="bg-base-300 font-bold text-base-content">
      <td>TOTALE MESE</td>

      <td class="text-right">
        <%= format_money(@daily_reports.sum(&:morning_total)) %>
      </td>

      <td class="text-right">
        <%= format_money(@daily_reports.sum(&:afternoon_total)) %>
      </td>

      <td class="text-right pr-6 text-lg">
        <%= format_money(@daily_reports.sum(&:total)) %>
      </td>

      <td></td>
    </tr>
  </tfoot>
<% end %>
